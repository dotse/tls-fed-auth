$schema: http://json-schema.org/schema#

type: object
required:
  - entities
properties:
  entities:
    type: array
    items:
      $ref: '#/definitions/entity'

definitions:
  entity:
    type: object
    required:
      - entity_id
      - authn
      - endpoints
    properties:
      entity_id:
        type: string
      authn:
        title: Entity authentication entries
        type: array
        items:
          $ref: '#/definitions/authn_entry'
      endpoints:
        type: array
        items:
          $ref: '#/definitions/endpoint'
  endpoint:
    type: object
    required:
      - fqdn
      - authz
    properties:
      fqdn:
        title: Fully Qualified Domain Name of endpoint
        type: string
    authn:
      title: Endpoint authentication entries
      type: array
      items:
        $ref: '#/definitions/authn_entry'
    authz:
      title: Endpoint authorization entries
      type: array
      items:
        $ref: '#/definitions/authz_entry'
    server_uri:
      title: Endpoint server URI
      type: string
      format: uri
  authn_entry:
    title: Authentication entry
    type: object
    properties:
      x509certificate:
        title: X.509 Certificate (PEM)
        type: string
  authz_entry:
    title: Authorization entry
    type: object
    properties:
      certificate_sha256:
        description: SHA-256 fingerprint of entity certificate
        type: string
        pattern: "^[0-9a-f]{64}$"
