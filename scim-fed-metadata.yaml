$schema: http://json-schema.org/schema#

type: object
required:
  - entities
properties:
  entities:
    type: array
    items:
      $ref: '#/definitions/entity'

definitions:
  entity:
    type: object
    additionalProperties: false
    required:
      - entity_id
      - authn
    properties:
      entity_id:
        type: string
      authn:
        title: Entity authentication entries
        type: array
        items:
          $ref: '#/definitions/authn_entry'
      servers:
        type: array
        items:
          $ref: '#/definitions/endpoint'
      clients:
        type: array
        items:
          $ref: '#/definitions/endpoint'
  endpoint:
    type: object
    additionalProperties: false
    required:
      - fqdn
      - authz
    properties:
      fqdn:
        title: Fully Qualified Domain Name of endpoint
        type: string
      authn:
        title: Endpoint authentication entries
        type: array
        items:
          $ref: '#/definitions/authn_entry'
      authz:
        title: Endpoint authorization entries
        type: array
        items:
          $ref: '#/definitions/authz_entry'
      uri:
        title: Endpoint URI
        type: string
        format: uri
  authn_entry:
    title: Authentication entry
    type: object
    additionalProperties: false
    properties:
      x509certificate:
        title: X.509 Certificate (PEM)
        type: string
  authz_entry:
    title: Authorization entry
    type: object
    additionalProperties: false
    properties:
      x509certificate_sha256:
        description: SHA-256 fingerprint of entity certificate
        type: string
        pattern: "^[0-9a-f]{64}$"
